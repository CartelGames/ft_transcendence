
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
	<script src="{% static 'js/script.js' %}" defer></script>
	<title>Transcendence Pong 42</title>
</head>
<body>

	{% csrf_token %}

<header>
	<nav class="header-items">
		<ul>
			<li><a href="#index" onclick="showDiv('index')">Home</a></li>
			{% if user.is_authenticated %}
			<li><a href="#profil" onclick="showDiv('profil')">My profile</a></li>
			{% else %}
			<li><a href="#login" onclick="showDiv('login')">Login</a></li>
			{% endif %}
		</ul>
	</nav>
</header>

<div class="content">
	<!-- index -->
	<div id="index" class="block">
		<div class="game">
			<h1>Welcome to our Transcendence !</h1>
			<canvas id="game" class="game"></canvas>
		</div>
	</div>
	

	<!-- login -->
	<div id="login" class="block">
		<div class="form-container">
			{% if user.is_authenticated %}
			<h2>You are already logged in !</h2>
			{% else %}
			<h2>Login</h2>
			<iframe name="login" style="display:none;"></iframe>
			<form id="loginForm" enctype="multipart/form-data" action="{% url 'index' %}" method="post">
				<input type="hidden" name="type" value="login">
				<label for="username">Username :</label>
				<input type="text" id="username" name="username" required>
				<label for="password">Password : </label>
				<input type="password" id="password" name="password" required>
				<label><a href="#signup" onclick="showDiv('signup')">Click here to signup !</a></label>
				<!-- <button type="submit">Se connecter</button> -->
				<div class="butt"><button type="submit" onclick="sendForm('loginForm', event)">Login</button></div>
				<!-- <button onclick="sendForm('loginForm', event)">Se connecter</button> -->
				<div id="error-form" class="error-form"></div>
			</form>
			{% endif %}
		</div>
	</div>

	<!-- signin -->
	<div id="signup" class="block">
		<div class="form-container">
			{% if user.is_authenticated %}
			<h2>You are already logged in !</h2>
			{% else %}
			<h2>Signup</h2>
			<iframe name="signup" style="display:none;"></iframe>
			<form id="signupForm" enctype="multipart/form-data" action="{% url 'index' %}" method="post">
				<input type="hidden" name="type" value="signup">
				<label for="signup-username">Username :</label>
				<input type="text" id="signup-username" name="username" required>
				<label for="signup-pseudo">Pseudo :</label>
				<input type="text" id="signup-pseudo" name="pseudo" required>
				<label for="signup-email">Email :</label>
				<input type="email" id="signup-email" name="email" required>
				<label for="signup-pass">Password : </label>
				<input type="password" id="signup-pass" name="password1" required>
				<label for="signup-pass-repeat">Repeat password : </label>
				<input type="password" id="signup-pass-repeat" name="password2" required>
				<div class="butt"><button type="submit" onclick="sendForm('signupForm', event)">Signup</button></div>
				<div id="error-form" class="error-form"></div>
			</form>
			{% endif %}
		</div>
	</div>

	<!-- profil -->
	<div id="profil" class="block profil">
		<div class="form-container">
			<h2>My profile</h2>
			<form id="profilImg" enctype="multipart/form-data" action="{% url 'index' %}" method="post">
				<input type="hidden" name="type" value="profilImg">
				<label for="profil-img" class="profil-img">
					<img id="img" src="{{ user.profil_img.url }}" alt="Profil Image" class="img-profil">
					<img class="overlay">
				</label>
				<input type="file" id="profil-img" name="profil_img" style="display: none;" accept="image/*">
				<div id="error-form" class="error-form"></div>
			</form>
			<p id="username"></p>
			<p id="pseudo"></p>
   			<p id="email"></p>
			<form id="profilForm" enctype="multipart/form-data" action="{% url 'index' %}" method="post">
				<input type="hidden" name="type" value="logout">
				<div class="butt"><button2 type="submit" onclick="sendForm('profilForm', event)">Logout</button></div>
				<div id="error-form" class="error-form"></div>
			</form>
		</div>
	</div>


	{% if user.is_authenticated %}
	<!-- chat -->
	<div id="chat" class="">
		<div id="chat-toggle" class="chat-toggle">
			<p>Friends list</p>
		</div>
		<div id="chat-content" class="chat-content">
			<div id="main-friends">
				<div id="friend">
					<a class="list-friends active" onclick="displayDiv('blocked-friends', 'friend')">Friends</a>
					<a class="list-friends" onclick="displayDiv('friend', 'blocked-friends')">Blocked</a>
					<p id="friends"></p>
					<div class="butt friend"><button type="submit" onclick="displayDiv('main-friends', 'add-friend')">Add a friend</button></div>
				</div>
				<div id="blocked-friends" style="display: none;">
					<a class="list-friends" onclick="displayDiv('blocked-friends', 'friend')">Friends</a>
					<a class="list-friends active" onclick="displayDiv('friend', 'blocked-friends')">Blocked</a>
					<p id="blocked-friend"></p>
				</div>
			</div>
			<div id="add-friend" style="display: none;">
				<form id="addFriendForm" enctype="multipart/form-data" action="{% url 'index' %}" method="post">
					<input type="hidden" name="type" value="addFriend">
					<input type="hidden" name="delete" value="false">
					<label for="addfriendName">Friend name :</label>
					<input type="text" id="addfriendName" name="addfriendName" required>
					<div id="error-form" class="error-form"></div>
					<div class="butt"><button type="submit" onclick="sendForm('addFriendForm', event)">Add</button></div>
					<div class="butt"><button2 type="submit" onclick="displayDiv('add-friend', 'main-friends'), loadFriends();">Back</button></div>
				</form>
			</div>
		</div>
	</div>
	{% endif %}
	
</div>

	<!-- <input type="hidden" id="image-url" value="{% static 'images/neon.jpg' %}">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
		<script type="module" src="{% static 'js/game.js' %}"></script> -->
</body>
</html>
